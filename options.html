<!doctype html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Redgifs Bulk Downloader — Settings</title>
    <style>
      body { font-family: system-ui, -apple-system, Segoe UI, Roboto, sans-serif; margin: 24px; }
      .card { max-width: 720px; border: 1px solid #ddd; border-radius: 12px; padding: 18px; }
      .row { display: flex; gap: 12px; align-items: center; flex-wrap: wrap; }
      button { padding: 10px 14px; border-radius: 10px; border: 1px solid #ccc; background: #fff; cursor: pointer; font-weight: 600; }
      button.danger { border-color: #d66; }
      .muted { color: #666; }
      .status { margin-top: 12px; padding: 10px 12px; border-radius: 10px; background: #f6f6f6; display: none; }
      label { user-select: none; }
      input[type="file"] { display:none; }
      .dim-row { display:flex; align-items:center; gap:10px; }
      .dim-label { width:80px; }

      @media (prefers-color-scheme: dark) {
        body { background: #1a1a1a; color: #e8e8e8; }
        .card { border-color: #333; background: #242424; }
        hr { border-top-color: #333 !important; }
        button { background: #2e2e2e; border-color: #555; color: #e8e8e8; }
        button.danger { border-color: #a44; }
        .status { background: #2e2e2e; }
        .muted { color: #999; }
        input[type="text"], input[type="number"] {
          background: #2e2e2e; border: 1px solid #555; color: #e8e8e8;
          border-radius: 4px; padding: 2px 4px;
        }
        select { background: #2e2e2e; border: 1px solid #555; color: #e8e8e8; }
        code { background: #333; border-radius: 3px; padding: 1px 4px; }
        #memClearPrompt { background: #3a2e00; border-color: #7a5c00; color: #f0c040; }
      }
    </style>
  </head>
  <body>
    <h1>Settings</h1>

    <div class="card">
      <div>
        <div><strong>Memory mode</strong></div>
        <div class="muted">Controls whether downloaded IDs are remembered.</div>
        <div style="margin-top:10px; display:flex; flex-direction:column; gap:6px;">
          <label><input type="radio" name="memoryMode" value="full"> Full — store all downloaded IDs (default)</label>
          <label><input type="radio" name="memoryMode" value="session"> Session-only — track this session in memory, nothing persisted</label>
          <label><input type="radio" name="memoryMode" value="none"> None — no tracking at all (privacy mode)</label>
        </div>

        <div id="memCountRow" style="margin-top:10px; display:flex; align-items:baseline; gap:8px;">
          <strong id="count">…</strong>
          <span class="muted">stored IDs</span>
          <button id="clear" class="danger" style="margin-left:8px;">Clear memory</button>
        </div>

        <div id="memClearPrompt" style="display:none; margin-top:10px; padding:10px 12px;
             border-radius:8px; background:#fff8e1; border:1px solid #f0c040; color:#7a5c00;">
          Your stored IDs will not be deleted automatically.
          <div style="margin-top:8px; display:flex; gap:8px;">
            <button id="memClearYes">Yes, delete stored IDs</button>
            <button id="memClearNo">No, keep them</button>
          </div>
        </div>
      </div>

      <hr style="margin:16px 0; border:none; border-top:1px solid #eee;" />

      <div>
        <div><strong>Dim strength</strong></div>
        <div class="muted">How strongly previously-downloaded tiles are grayed out.</div>
        <div style="margin-top:10px;">
          <label><input type="checkbox" id="dimRemove"> Hide tiles in memory from the feed</label>
        </div>
        <div id="dimControls" style="margin-top:12px; display:flex; flex-direction:column; gap:10px;">
          <div class="dim-row">
            <label class="dim-label">Grayscale</label>
            <input type="range" id="dimGrayscale" min="0" max="100" step="1" style="width:180px;">
            <span id="dimGrayscaleVal">100</span>%
          </div>
          <div class="dim-row">
            <label class="dim-label">Brightness</label>
            <input type="range" id="dimBrightness" min="0" max="200" step="1" style="width:180px;">
            <span id="dimBrightnessVal">62</span>%
          </div>
          <div class="dim-row">
            <label class="dim-label">Contrast</label>
            <input type="range" id="dimContrast" min="0" max="200" step="1" style="width:180px;">
            <span id="dimContrastVal">115</span>%
          </div>
          <div class="dim-row">
            <label class="dim-label">Opacity</label>
            <input type="range" id="dimOpacity" min="0" max="100" step="1" style="width:180px;">
            <span id="dimOpacityVal">78</span>%
          </div>
          <div style="margin-top:4px;">
            <button id="dimRevertDefaults">Revert to defaults</button>
          </div>
        </div>
      </div>

      <hr style="margin:16px 0; border:none; border-top:1px solid #eee;" />

      <div>
        <div><strong>Download speed</strong></div>
        <div class="muted">Delay between consecutive downloads to avoid rate-limiting.</div>
        <div class="row" style="margin-top:10px;">
          <label><input type="radio" name="downloadSpeed" value="fast"> Fast (100–300 ms)</label>
          <label><input type="radio" name="downloadSpeed" value="normal"> Normal (400–900 ms)</label>
          <label><input type="radio" name="downloadSpeed" value="slow"> Slow (1–2 s)</label>
          <label><input type="radio" name="downloadSpeed" value="custom"> Custom</label>
        </div>
        <div id="customDelayBlock" style="display:none; margin-top:10px;">
          Min: <input type="number" id="delayMin" min="0" max="30000" style="width:80px;"> ms
          &nbsp;&nbsp;
          Max: <input type="number" id="delayMax" min="0" max="30000" style="width:80px;"> ms
        </div>
      </div>

      <hr style="margin:16px 0; border:none; border-top:1px solid #eee;" />

      <div>
        <div><strong>Notifications</strong></div>
        <div style="margin-top:8px;">
          <label><input type="checkbox" id="notifications">
            Enable desktop notifications when downloads finish</label>
        </div>
        <div class="muted" style="margin-top:4px;">Off by default. Requires browser permission prompt on first use.</div>
      </div>

      <hr style="margin:16px 0; border:none; border-top:1px solid #eee;" />

      <div>
        <div><strong>Filename format</strong></div>
        <div class="muted" style="margin-top:4px;">
          Tags: &lt;id&gt; &nbsp; &lt;date&gt; &nbsp; &lt;date(YYYY-MM-DD)&gt; &nbsp; &lt;index&gt;
          <br>Example: <code>redgifs_&lt;id&gt;_&lt;date&gt;</code> → redgifs_abc123_20260301.mp4
        </div>
        <div style="margin-top:8px;">
          <input type="text" id="filenameFormat" placeholder="&lt;id&gt;" style="width:320px;">
        </div>
        <div id="filenameWarning" style="display:none; color:#c80; margin-top:6px;">
          &#9888; &lt;id&gt; not included — duplicate filenames possible if downloading multiple videos.
        </div>
      </div>

      <hr style="margin:16px 0; border:none; border-top:1px solid #eee;" />

      <div>
        <div><strong>Button position</strong></div>
        <div class="muted" style="margin-top:4px;">Corner where the download button appears.</div>
        <div style="margin-top:10px; display:flex; flex-direction:column; gap:10px;">
          <label>Embed pages:
            <select id="btnCornerEmbed" style="margin-left:6px;">
              <option value="top-left">Top-left</option>
              <option value="top-right">Top-right</option>
              <option value="bottom-left">Bottom-left</option>
              <option value="bottom-right">Bottom-right</option>
            </select>
          </label>
          <label>Creator pages:
            <select id="btnCornerPage" style="margin-left:6px;">
              <option value="top-left">Top-left</option>
              <option value="top-right">Top-right</option>
              <option value="bottom-left">Bottom-left</option>
              <option value="bottom-right">Bottom-right</option>
            </select>
          </label>
        </div>
      </div>

      <hr style="margin:16px 0; border:none; border-top:1px solid #eee;" />

      <div>
        <div><strong>Export / Import</strong></div>
        <div class="muted">Export your downloaded ID list to JSON or import it on another machine.</div>

        <div class="row" style="margin-top:10px;">
          <button id="export">Export JSON</button>
          <button id="importBtn">Import JSON</button>
          <input id="importFile" type="file" accept="application/json,.json" />
        </div>

        <div id="importMode" style="display:none; margin-top:10px;">
          <span id="importFileName" class="muted"></span>
          <div class="row" style="margin-top:8px;">
            <button id="importMerge">Merge</button>
            <button id="importOverride">Override</button>
            <button id="importCancel">Cancel</button>
          </div>
        </div>
      </div>

      <div id="status" class="status"></div>

      <hr style="margin:16px 0; border:none; border-top:1px solid #eee;" />

      <div style="display:flex; align-items:center; gap:12px; font-size:12px;">
        <span class="muted">Version <span id="currentVersion">…</span></span>
        <span id="updateStatus" class="muted"></span>
        <a href="https://github.com/irish8096/redgifs-bulk-downloader" target="_blank" rel="noopener" class="muted">GitHub</a>
      </div>
    </div>

    <script src="options.js"></script>
  </body>
</html>
